@page "/temperature-rate-charts/{PatientId:int}"
@using ClinicManager.Shared.DTO_s.Charts
@using ClinicManager.Shared.DTO_s.Charts.ChartEntry
@using ClinicManager.Shared.DTO_s.Records
@using ClinicManager.Shared.Wrappers
@using ClinicManager.Web.Infrastructure.Services.Chart
@inject IChartService chartService 

<MudGrid>
    <MudItem xs="12" md="12" sm="12">
        <MudText Align="Align.Center" Typo="Typo.h6">
            Temperature Rate Charts
        </MudText>
    </MudItem>
    <MudItem xs="12" md="12" sm="12">
      <MudButton Variant="Variant.Outlined" Color="Color.Info"
                               Style="border-radius:10px 10px 10px 10px"
                               @onclick="@(() => _navigationManager.NavigateTo($"/patient-charts/{PatientId}"))">Back</MudButton>
    </MudItem>
</MudGrid>
@if
(
    _temperatureRateCharts.Count() > 0 
)
{
<MudGrid>
 @if (_temperatureRateCharts.Any())
{
   <MudItem xs="12" md="12" sm="12">
            <MudGrid>
                @foreach (var chart in _temperatureRateCharts)
                {
                    <MudItem md="3" sm="3">
                          <MudCard>
                            <MudCardHeader>
                                <CardHeaderAvatar>
                                    <MudText Typo="Typo.inherit">
                                    @*<MudChip Color="Color.Warning">@chart.Time</MudChip>*@
                                    </MudText>
                                </CardHeaderAvatar>
                                <CardHeaderContent> 
                                <center>
                                    Temperature Chart @chart.TempRatetId
                                </center> 
                                </CardHeaderContent>
                            </MudCardHeader>
                            <MudCardContent>
                                <MudGrid>
                                    <MudItem md="12" sm="12">
                                        <center>
                                        <MudButton Color="Color.Dark" 
                                        Style="border-radius:10px 10px 10px 10px" @onclick="@(() => ViewTemperatureChart(@chart.TempRatetId))"
                                        Variant="Variant.Outlined">View</MudButton>
                                        </center>                 
                                    </MudItem>
                                </MudGrid>
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                }
            </MudGrid>
    </MudItem>
}
</MudGrid>
}
else
{
    <MudItem xs="12" md="12" sm="12">
        <MudText Align="Align.Center" Typo="Typo.body1">No Temperature Rate Charts Found</MudText> 
    </MudItem>
}

@code {
    [Parameter] public int PatientId { get; set; } 
    private List<TemperatureRateDTO> _temperatureRateCharts = new();

    protected async override Task OnInitializedAsync()
    {     
        await GetAllTemperatureRateCharts();
    }

    private void ViewTemperatureChart(int tempRatetId)
    {
        var parameters = new DialogParameters();
        parameters.Add(nameof(ViewTemperatureRateChart.AddTemperatureChartModel ), new TemperatureRateDTO
        {
            TempRatetId = tempRatetId
        });
        var options = new DialogOptions() { CloseButton = true, MaxWidth = MaxWidth.ExtraLarge, };
        _dialogService.Show<ViewTemperatureRateChart>("Temperature Rate Chart", parameters, options);
    }

    public async Task GetAllTemperatureRateCharts()
    {
        var charts = await chartService.GetAllTemperatureRate();
        if (charts.Succeeded)
        {
            _temperatureRateCharts = charts.Data;
        }
    }
}